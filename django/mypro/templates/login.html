<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
   
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous"> <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
   <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script> -->
   <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css">
</head>
<body>
  {% if messages %}
  <ul class="messages">
      {% for message in messages %}
      <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
      {% endfor %}
  </ul>
  {% endif %}
    <section class="vh-100" style="background-color: #eee;">
        <div class="container h-100">
          <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col-lg-12 col-xl-11">
              <div class="card text-black" style="border-radius: 25px;">
                <div class="card-body p-md-5">
                  <div class="row justify-content-center">
                    <div class="col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1">
      
                      <p class="text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4">Login</p>
      
                      <form class="mx-1 mx-md-4">
                          <!-- {% csrf_token %} -->
                      
                        <div class="d-flex flex-row align-items-center mb-4">
                          <i class="fas fa-envelope fa-lg me-3 fa-fw"></i>
                          <div class="form-outline flex-fill mb-0">
                            <input type="email" name="email" id="email" class="form-control"/>
                            <label class="form-label" for="form3Example3c">Your Email</label>
                            <span class="email_error text-danger" style="display: none;">Enter Email</span>
                          </div>
                        </div>
      
                        <div class="d-flex flex-row align-items-center mb-4">
                          <i class="fas fa-lock fa-lg me-3 fa-fw"></i>
                          <div class="form-outline flex-fill mb-0">
                            <input type="password" name="password" id="password" class="form-control"/>
                            <label class="form-label" for="form3Example4c">Password</label>
                            <span class="password_error text-danger" style="display: none;">Enter Password</span>
                            <span class="password_length text-danger" style="display: none;">Password Lenghth is too short</span>

                            
                          </div>
                        </div>
      
                     
      
      
                        <div class="d-flex justify-content-center mx-4 mb-3 mb-lg-4">
                          <button type="button" class=" login btn btn-primary btn-lg">Login</button>
                        </div>
      
                      </form>

<script type="text/javascript">
   
    // $('.login').on('click',function(e){
     
    //    e.preventDefault();
    //    if($('#email').val()==" "){
    //     $('.email_error').css("display", "block")
    //     return false
    //   }
      //  $.ajax({
      //    type:'POST',
      //    url:'register',
      //    data:{
      //     email:$('#email').val(),
      //     password:$('password').val(),
      //     csrfmiddlewaretoken: '{{ csrf_token }}'

      //    },
      //    success:function(data){
      //      if(data.msg=='Success'){
      //       //  alert('logged inn')
      //      }
      //      else{
      //       //  alert('error')
      //      }
      //    }
      //  })
    // })

    $(document).ready(function(){
      $('.login').click(function(e){
            e.preventDefault();
            let submit = true;
            if ($('#email').val() == ''){
                $('.email_error').css('display','block');
                return;

            }
            else{
              submit = true;
              $('.email_error').css('display','none')
            }

            if ($('#password').val() == ''){
               
                $('.password_error').css('display','block');
                return false;
            }
            else if($('#password').val().length<=3){
             
              $('.password_length').css('display','block')
              return false;
            }
            else{
              submit = true;
              $('.password_error').css('display','none')
            }


            console.log("bbububbu")
            $.ajax({
            type:'POST',
            url:"{% url 'login' %}",
            data:{
              email:$('#email').val(),
              password:$('#password').val(),
              csrfmiddlewaretoken: '{{ csrf_token }}'

            },
            success:function(response){
              console.log(response,'====')
              if(response.status==true){
                console.log('==================in true')
                setTimeout(() => {
                          window.location.href = "/"    
                        }, 2000); 
                 alert('logged inn')
              }
              else{
                window.location.reload()
              }
            }
          })



    })
  })





</script>
</body>
</html>